<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="topic_udq_swp_xrb">
    <title>Log4Shell - Oxygen XML Vulnerability Analysis FAQ</title>
    <prolog>
        <author>cristi_talau</author>
        <critdates>
            <created date="2021-12-15"/>
        </critdates>
        <metadata>
            <keywords>
                <keyword outputclass="label">Security</keyword>
            </keywords>
        </metadata>
    </prolog>
    <body>
        <p>NIST has announced a recent vulnerability (<xref
                href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" format="html"
                scope="external">CVE-2021-44228</xref>) in the <xref
                href="https://logging.apache.org/log4j/2.x/index.html" format="html"
                scope="external">Apache Log4j</xref> library. Syncro Soft has released a new
            critical security advisory <xref
                href="https://www.oxygenxml.com/security/advisory/CVE-2021-44228.html" format="html"
                scope="external">CVE-2021-44228</xref> and prepared this page containing frequently
            asked questions and answers related to this vulnerability and its impact on our software
            products.</p>
        <p>Because of the ubiquity of the log4j component, the situation is still developing. Please
            subscribe to our Security Advisories mailing list (found on the top of the <xref
                href="https://www.oxygenxml.com/security/advisories.html" format="html"
                scope="external">Security Advisories page</xref> ), and revisit this page
            periodically to get the latest information.</p>
        <ol id="ul_sxk_czp_xrb">
            <li>How to protect against this vulnerability?<ul id="ul_txk_czp_xrb">
                    <li>Upgrade to the latest version of our products.</li>
                    <li>If you cannot upgrade, set the <codeph>-Dlog4j2.formatMsgNoLookups=true</codeph> system
                        property or <codeph>LOG4J_FORMAT_MSG_NO_LOOKUPS="true"</codeph> environment
                        variable.</li>
                </ul></li>
            <li>How do I set this system property or environment variable?<ul id="ul_uxk_czp_xrb">
                    <li><xref
                            href="https://www.oxygenxml.com/doc/ug-webauthor/topics/webauthor-set-system-property.html"
                            format="html" scope="external">Oxygen Web Author</xref><p><b>Note:</b>
                            The system property is not inherited when using the Web Author PDF
                            Publishing (not included by default), so upgrading this plugin is
                            required.</p></li>
                    <li>Oxygen XML Editor / Author / Developer<ul id="ul_kgr_1wx_xrb">
                            <li>For Windows and Linux installations there are several files with the
                                .vmoptions extension in the installation directory. You should
                                append the following line to each of them using a text editor such
                                as
                                Notepad:<codeblock id="codeblock_zlx_gwx_xrb">-Dlog4j2.formatMsgNoLookups=true</codeblock></li>
                            <li>For MacOS there are a number of installed applications. For each of
                                them follow these steps:<ol id="ol_an1_swx_xrb">
                                    <li id="set-parameters-for-application-launchers_li_uks_bgk_54b"
                                            ><b>Command + Single-Click </b> (or right-click) the
                                        application icon in <b>Finder</b>.</li>
                                    <li id="set-parameters-for-application-launchers_li_vks_bgk_54b"
                                        >From the contextual menu, select <b>Show Package
                                            Contents</b>.</li>
                                    <li id="set-parameters-for-application-launchers_li_wks_bgk_54b"
                                        >Go to the contents directory and edit the Info.plist
                                            file.<note id="note_ubx_5wx_xrb">You can open this file
                                            either with the <b>Property List Editor</b>, or the
                                                <b>TextEdit</b>.</note></li>
                                    <li id="set-parameters-for-application-launchers_li_yks_bgk_54b"
                                        >Look for the <b>VMOptionArray</b> key and add the system
                                        property in a new <codeph>&lt;string></codeph> element from
                                        the <codeph>&lt;array></codeph> element. For
                                        example:<codeblock id="codeblock_vh1_xwx_xrb">
&lt;key>VMOptionArray&lt;/key>
&lt;array>
  &lt;string>-Dlog4j2.formatMsgNoLookups=true&lt;/string>
  ...
&lt;/array></codeblock></li>
                                </ol></li>
                        </ul>After this setting you need to restart the application.<note
                            id="note_gn4_1xx_xrb">Setting the environment variable
                                <codeph>LOG4J_FORMAT_MSG_NO_LOOKUPS="true"</codeph> is preferred
                            since it will be also inherited by processes created when running a
                            transformation scenario.</note></li>
                    <li>Oxygen PDF Chemistry: Open the chemistry.bat file from the installation
                        directory and add the <codeph>-Dlog4j2.formatMsgNoLookups=true</codeph> just
                        before the <codeph>-cp</codeph> command line option (you can search for this
                        flag).</li>
                    <li>Oxygen Content Fusion:<ul id="ul_cyk_czp_xrb">
                            <li>Set the <codeph>LOG4J_FORMAT_MSG_NO_LOOKUPS=true</codeph>
                                environment variable for the <i>license-servlet</i>,
                                    <i>review-api</i> &amp; <i>webauthor</i> services by editing the
                                    <i>/fusion/docker-compose.override.yml</i>
                                        file:<pre id="pre_fyk_czp_xrb">version: "3.5"
services:
  license-servlet:
    mac_address: EXAMPLE_VALUE_SHOULD_NOT_BE_CHANGED
    environment:
    - LOG4J_FORMAT_MSG_NO_LOOKUPS="true"
  review-api:
    environment:
    - LOG4J_FORMAT_MSG_NO_LOOKUPS="true"
  webauthor:
    environment:
    - LOG4J_FORMAT_MSG_NO_LOOKUPS="true"
</pre><p><b>Note: Important:</b></p><ul id="ul_hyk_czp_xrb">
                                    <li>White-space is very important in the above file.</li>
                                    <li>The <codeph>mac_address</codeph> entry should not be
                                        changed.</li>
                                </ul></li>
                            <li><xref
                                    href="https://www.oxygenxml.com/doc/ug-content-fusion/topics/cf-restart.html"
                                    format="html" scope="external">Restart Content
                                Fusion</xref></li>
                        </ul></li>
                    <li><xref href="https://www.oxygenxml.com/log_for_shell_license_servlet.html"
                            format="html" scope="external">License server</xref></li>
                </ul></li>
            <li>Am I still vulnerable if I set the <codeph>-Dlog4j2.formatMsgNoLookups=true</codeph>
                system property?<ul id="ul_pyk_czp_xrb">
                    <li>No. This is one of the recommended ways to protect against the
                        vulnerability.</li>
                </ul></li>
            <li>Am I still vulnerable if I set the environment variable:
                    <codeph>LOG4J_FORMAT_MSG_NO_LOOKUPS="true"</codeph> ?<ul id="ul_tyk_czp_xrb">
                    <li>No. This may be the easier way to protect against this vulnerability. It can
                        be set server-wide to protect all applications using Log4j. It can also be
                        set for entire kubernetes clusters using kubectl set env.</li>
                </ul></li>
            <li>Am I still vulnerable if I block all outbound traffic?<ul id="ul_uyk_czp_xrb">
                    <li>If you block ALL the outbound traffic, you may be safe, but:<ul
                            id="ul_vyk_czp_xrb">
                            <li>be sure to block also DNS traffic as it can exfiltrate data such as
                                environment variables</li>
                            <li>be sure to re-assess which servers are trusted - maybe some trusted
                                servers had the same vulnerability and were exploited</li>
                        </ul></li>
                    <li>Either way, it is a very good idea to restrict outbound traffic from Oxygen
                        tools. This will protect you against various types of vulnerabilities.</li>
                </ul></li>
            <li>Am I still vulnerable if I use a new version of Java?<ul id="ul_zyk_czp_xrb">
                    <li>The vulnerability is know to exist with the latest versions of Java (e.g. >
                        1.8u191) if you are also using <xref
                            href="https://github.com/veracode-research/rogue-jndihttps://github.com/veracode-research/rogue-jndi"
                            format="html" scope="external">Apache Tomcat or Webshpere</xref>. If you
                        are not using those servers, you may still be vulnerable, but we are not
                        aware of any exploit.</li>
                </ul></li>
            <li>Should I remove the JndiLookup class?<ul id="ul_azk_czp_xrb">
                    <li>Removing it will remove the vulnerable code. We have high confidence that
                        other problems will not be generated.</li>
                </ul></li>
            <li>Should I set firewall rules based on HTTP headers or URLs to block attacks?<ul
                    id="ul_czk_czp_xrb">
                    <li>This kind of rules do not offer full protection. The URLs that exploit the
                        vulnerability can be written in various ways and are not recognized by
                        common WAF rules that you might find.</li>
                </ul></li>
            <li>How to test if I am vulnerable?<ul id="ul_dzk_czp_xrb">
                    <li>If you did not apply any mitigation, you can assume you are.</li>
                </ul></li>
            <li>Should I do anything if the affected server is deployed inside the intranet?<ul
                    id="ul_ezk_czp_xrb">
                    <li>Yes. The attack can be triggered from another server that was exploited or
                        by one of the employees when they follow a link in a phishing email.</li>
                </ul></li>
            <li>Should I upgrade to the latest version of your products?<ul id="ul_jzk_czp_xrb">
                    <li>Yes. New maintenance builds that avoid this vulnerability are available for
                        versions that are in the maintenance period.</li>
                </ul></li>
            <li>Is this vulnerability related to Java being insecure?<ul id="ul_kzk_czp_xrb">
                    <li>No. It is caused by an open-source component called log4j which had a
                        vulnerability. This component is widely used in the Java ecosystem.</li>
                </ul></li>
            <li>How is Syncro Soft addressing the problem:<ul id="ul_lzk_czp_xrb">
                    <li>We patched all our public servers against this vulnerability.</li>
                    <li>We provided a security advisory with current solutions <xref
                            href="https://www.oxygenxml.com/security/advisory/CVE-2021-44228.html"
                            format="html" scope="external"/> and we produced maintenance builds that
                        remove the vulnerable version of log4j for all product versions that are
                        under maintenance. We are working on solutions for older versions.</li>
                    <li>We analyzed and updated our internal servers to make sure they are not
                        vulnerable.</li>
                    <li>We scanned the logs of the services we use or provide to look for the
                        pattern that triggers the vulnerability.</li>
                </ul></li>
        </ol>
    </body>
    <related-links>
        <link href="https://www.lunasec.io/docs/blog/log4j-zero-day/" format="html" scope="external"/>
        <link
            href="https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/"
            format="html" scope="external"/>
        <link href="https://www.oxygenxml.com/security/advisory/CVE-2021-44228.html" format="html"
            scope="external"/>
    </related-links>
</topic>
